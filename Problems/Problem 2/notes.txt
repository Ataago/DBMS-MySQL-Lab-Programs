a) Create the tables for the schemas provided with primary keys and foreign keys 

SQL> create table flight(
  2     f_no number(5),
  3     from_city varchar(10),
  4     to_city varchar(10),
  5     dist number(10),
  6     dep interval day(0) to second (0),
  7     ari interval day(0) to second (0),
  8     price real,
  9     primary key(f_no))

SQL> create table aircraft(
  2  a_id number(5),
  3  a_name varchar(10),
  4  cruse_range number(10),
  5  primary key(a_id));

SQL> create table a_employee(
  2  e_id number(5),
  3  e_name varchar(20),
  4  sal number(5),
  5  primary key(e_id));

SQL> create table certified(
        e_id number(5),
        a_id number(5),
        constraint certifications
        foreign key(e_id) references a_employee(e_id),
        foreign key(a_id) references aircraft(a_id));



b) Insert 5 tuples of values to each table. 

SQL> insert into flight values('&f_no','&from_city','&to_city','&dist',to_dsinterval('&dep'),to_dsinterval('&ari'),'&price');
SQL> insert into aircraft values('&a_id','&a_name','&curse_range');
SQL> insert into a_employee values('&e_id','&e_name','&sal');
SQL> insert into certified values('&e_id','&a_id');


c) Find the names of aircraft such that all pilots certified to operate them have salaries more than Rs.80, 000. 

SQL> select a_name as Aircraft_Name
  2  from aircraft
  3  where
  4     a_id in (
  5                     select certified.a_id
  6                     from certified, a_employee
  7                     where
  8                             certified.e_id = a_employee.e_id
  9                             group by certified.a_id
 10                                     having min(a_employee.sal) > 90000
 11             );

d) For each pilot who is certified for more than three aircrafts, find the eid and the maximum cruisingrange of the aircraft for which she or he is certified. 

SQL> select certified.e_id as Emp_ID, max(aircraft.cruse_range) as Max_Cruse_Range
  2  from certified, aircraft
  3  where
  4     certified.a_id = aircraft.a_id
  5     group by certified.e_id
  6*            having count(certified.e_id) > 3

e) Find the names of pilots whose salary is less than the price of the cheapest route from Bengaluru to Frankfurt. 

SQL> select e_name
from a_employee
 where sal < (
                    select min(price)
                    from flight
                    where
                            from_city = 'bng' and
                            to_city = 'hyd'
		)

 